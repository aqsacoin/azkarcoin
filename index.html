<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AzkarCoin</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet">
</head>
<body>
  <header>
    <h1>AZKARCOIN</h1>
    <p>ألا بذكر الله تطمئن القلوب</p>
  </header>

  <div class="container">
    <div class="user-info">
      <h2>مرحبا بك</h2>
      <p>عدد العملات: <span id="user-coins">0</span></p>
    </div>

    <!-- أزرار الأذكار -->
    <div id="azkar-buttons" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
      <button id="subhanAllah-btn" onclick="azkarClicked('subhanAllah')" disabled>سبحان الله</button>
      <button id="alhamdulillah-btn" onclick="azkarClicked('alhamdulillah')" disabled>الحمد لله</button>
      <button id="laIlahaIllallah-btn" onclick="azkarClicked('laIlahaIllallah')" disabled>لا إله إلا الله</button>
      <button id="allahuAkbar-btn" onclick="azkarClicked('allahuAkbar')" disabled>الله أكبر</button>
    </div>

    <!-- زر التعدين والمؤقت -->
    <div id="mining-section">
      <button id="start-mining-btn" onclick="startMining()" disabled>ابدأ التعدين</button>
      <div id="mining-timer"></div>
    </div>
  </div>

  <footer>
    <p>جميع الحقوق محفوظة</p>
  </footer>

  <script>
    let userCoins = localStorage.getItem("userCoins") || 50;
    let miningInterval = 86400 * 1000; // 24 ساعة بالمللي ثانية
    let miningEndTime = localStorage.getItem("miningEndTime");
    let azkarClickedFlags = {
      subhanAllah: false,
      alhamdulillah: false,
      laIlahaIllallah: false,
      allahuAkbar: false
    };

    // تحديث العملات بعد تسجيل الدخول الأول
    document.getElementById("user-coins").textContent = userCoins;

    // بدء دورة التعدين عند تسجيل الدخول لأول مرة
    if (!miningEndTime) {
      startInitialMining();
    } else {
      checkMiningStatus();
    }

    function startInitialMining() {
      let endTime = Date.now() + miningInterval;
      localStorage.setItem("miningEndTime", endTime);
      startMiningCountdown(endTime);
    }

    function checkMiningStatus() {
      let remainingTime = miningEndTime - Date.now();
      if (remainingTime > 0) {
        startMiningCountdown(miningEndTime);
      } else {
        // بعد انتهاء المؤقت يمنح المستخدم 10 عملات وتفعيل الأذكار
        userCoins = parseInt(userCoins) + 10;
        localStorage.setItem("userCoins", userCoins);
        document.getElementById("user-coins").textContent = userCoins;
        enableAzkarButtons();
      }
    }

    function startMiningCountdown(endTime) {
      let timerElement = document.getElementById("mining-timer");
      let interval = setInterval(() => {
        let remainingTime = endTime - Date.now();

        if (remainingTime <= 0) {
          clearInterval(interval);
          timerElement.textContent = "انتهى وقت التعدين!";
          enableAzkarButtons();
        } else {
          let hours = Math.floor((remainingTime / (1000 * 60 * 60)) % 24);
          let minutes = Math.floor((remainingTime / (1000 * 60)) % 60);
          let seconds = Math.floor((remainingTime / 1000) % 60);
          timerElement.textContent = `الوقت المتبقي: ${hours} : ${minutes < 10 ? '0' + minutes : minutes} : ${seconds < 10 ? '0' + seconds : seconds}`;
        }
      }, 1000);
    }

    function azkarClicked(azkar) {
      azkarClickedFlags[azkar] = true;

      // تفعيل زر "ابدأ التعدين" إذا تم الضغط على جميع الأذكار
      if (Object.values(azkarClickedFlags).every(flag => flag)) {
        document.getElementById("start-mining-btn").disabled = false;
      }
    }

    function startMining() {
      // تعطيل زر "ابدأ التعدين" وبدء دورة تعدين جديدة
      document.getElementById("start-mining-btn").disabled = true;
      disableAzkarButtons();

      let endTime = Date.now() + miningInterval;
      localStorage.setItem("miningEndTime", endTime);
      startMiningCountdown(endTime);

      // إعادة تعيين الأذكار بعد بدء التعدين
      azkarClickedFlags = {
        subhanAllah: false,
        alhamdulillah: false,
        laIlahaIllallah: false,
        allahuAkbar: false
      };
    }

    function enableAzkarButtons() {
      document.getElementById("subhanAllah-btn").disabled = false;
      document.getElementById("alhamdulillah-btn").disabled = false;
      document.getElementById("laIlahaIllallah-btn").disabled = false;
      document.getElementById("allahuAkbar-btn").disabled = false;
    }

    function disableAzkarButtons() {
      document.getElementById("subhanAllah-btn").disabled = true;
      document.getElementById("alhamdulillah-btn").disabled = true;
      document.getElementById("laIlahaIllallah-btn").disabled = true;
      document.getElementById("allahuAkbar-btn").disabled = true;
    }
  </script>
</body>
</html>