<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AzkarCoin</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet">
</head>
<body>
  <header>
    <h1>AZKARCOIN</h1>
    <p>ألا بذكر الله تطمئن القلوب</p>
  </header>

  <div class="container">
    <div class="user-info">
      <h2>مرحبا بك</h2>
      <p>عدد العملات: <span id="user-coins">0</span></p>
    </div>

    <!-- أزرار الأذكار -->
    <div id="azkar-buttons" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
      <button id="subhanAllah-btn" onclick="azkarClicked('subhanAllah')" disabled>سبحان الله</button>
      <button id="alhamdulillah-btn" onclick="azkarClicked('alhamdulillah')" disabled>الحمد لله</button>
      <button id="laIlahaIllallah-btn" onclick="azkarClicked('laIlahaIllallah')" disabled>لا إله إلا الله</button>
      <button id="allahuAkbar-btn" onclick="azkarClicked('allahuAkbar')" disabled>الله أكبر</button>
    </div>

    <!-- زر التعدين والمؤقت -->
    <div id="mining-section">
      <button id="start-mining-btn" onclick="startMining()" disabled>ابدأ التعدين</button>
      <div id="mining-timer"></div>
    </div>
  </div>

  <footer>
    <p>جميع الحقوق محفوظة</p>
  </footer>

  <script>
    let userCoins = parseInt(localStorage.getItem("userCoins") || 0);
    const miningInterval = 24 * 60 * 60 * 1000; // 24 ساعة بالمللي ثانية
    let miningEndTime = parseInt(localStorage.getItem("miningEndTime") || 0);
    let azkarClickedFlags = {
      subhanAllah: false,
      alhamdulillah: false,
      laIlahaIllallah: false,
      allahuAkbar: false
    };

    // تحديث عرض العملات
    function updateCoinsDisplay() {
      document.getElementById("user-coins").textContent = userCoins;
    }

    // منح المستخدم 50 عملة عند التسجيل لأول مرة
    function initializeUserCoins() {
      if (userCoins === 0) {
        userCoins = 50;
        localStorage.setItem("userCoins", userCoins);
      }
      updateCoinsDisplay();
    }

    // بدء العد التنازلي عند تسجيل الدخول
    function startInitialMiningCountdown() {
      if (miningEndTime === 0) {
        miningEndTime = Date.now() + miningInterval;
        localStorage.setItem("miningEndTime", miningEndTime);
      }
      startMiningCountdown();
    }

    // فحص حالة التعدين عند تسجيل الدخول
    function checkMiningStatus() {
      if (Date.now() >= miningEndTime) {
        userCoins += 10;
        localStorage.setItem("userCoins", userCoins);
        miningEndTime = 0;
        localStorage.removeItem("miningEndTime");
        updateCoinsDisplay();
        enableAzkarButtons();
      } else {
        startMiningCountdown();
      }
    }

    // بدء عد تنازلي للتعدين
    function startMiningCountdown() {
      const timerElement = document.getElementById("mining-timer");
      const interval = setInterval(() => {
        const remainingTime = miningEndTime - Date.now();

        if (remainingTime <= 0) {
          clearInterval(interval);
          timerElement.textContent = "انتهى وقت التعدين!";
          enableAzkarButtons();
          checkMiningStatus();
        } else {
          const hours = Math.floor((remainingTime / (1000 * 60 * 60)) % 24);
          const minutes = Math.floor((remainingTime / (1000 * 60)) % 60);
          const seconds = Math.floor((remainingTime / 1000) % 60);
          timerElement.textContent = `الوقت المتبقي: ${hours}:${minutes < 10 ? '0' + minutes : minutes}:${seconds < 10 ? '0' + seconds : seconds}`;
        }
      }, 1000);
    }

    // تمكين أزرار الأذكار بعد انتهاء التعدين
    function enableAzkarButtons() {
      Object.keys(azkarClickedFlags).forEach(id => {
        document.getElementById(id + '-btn').disabled = false;
      });
    }

    // تسجيل الضغط على أزرار الأذكار
    function azkarClicked(azkar) {
      azkarClickedFlags[azkar] = true;

      // تفعيل زر "ابدأ التعدين" إذا تم الضغط على جميع الأذكار
      if (Object.values(azkarClickedFlags).every(flag => flag)) {
        document.getElementById("start-mining-btn").disabled = false;
      }
    }

    // بدء دورة تعدين جديدة
    function startMining() {
      document.getElementById("start-mining-btn").disabled = true;
      Object.keys(azkarClickedFlags).forEach(id => {
        azkarClickedFlags[id] = false;
        document.getElementById(id + '-btn').disabled = true;
      });

      miningEndTime = Date.now() + miningInterval;
      localStorage.setItem("miningEndTime", miningEndTime);
      startMiningCountdown();
    }

    // تهيئة البيانات عند بدء التشغيل
    initializeUserCoins();
    if (miningEndTime === 0) {
      startInitialMiningCountdown();
    } else {
      checkMiningStatus();
    }
  </script>
</body>
</html>